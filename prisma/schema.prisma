// schema.prisma

generator client {
  provider = "prisma-client-js" // แก้จาก prisma-client-node เป็น js
}

datasource db {
  provider = "mongodb"
}

model Room {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  room_id  String @unique
  room_name String
  room_type String
}

model StudentGroup {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  group_id    String     @unique
  group_name  String
  group_count Int
  advisor     String
  registers   Register[]
}

model Subject {
  id           String     @id @default(auto()) @map("_id") @db.ObjectId
  subject_id   String     @unique
  subject_name String
  theory       Int
  practice     Int
  credit       Int
  teaches      Teach[]
  registers    Register[]
}

model Teacher {
  id           String  @id @default(auto()) @map("_id") @db.ObjectId
  teacher_id   String  @unique
  teacher_name String
  role         String
  teaches      Teach[]
}

model Timeslot {
  id          String @id @default(auto()) @map("_id") @db.ObjectId
  timeslot_id String @unique
  day         String
  period      Int
  start       String
  end         String
}

model Teach {
  id         String  @id @default(auto()) @map("_id") @db.ObjectId
  teacher_id String
  subject_id String
  teacher    Teacher @relation(fields: [teacher_id], references: [teacher_id])
  subject    Subject @relation(fields: [subject_id], references: [subject_id])

  @@unique([teacher_id, subject_id])
}

model Register {
  id         String       @id @default(auto()) @map("_id") @db.ObjectId
  group_id   String
  subject_id String
  group      StudentGroup @relation(fields: [group_id], references: [group_id])
  subject    Subject      @relation(fields: [subject_id], references: [subject_id])

  @@unique([group_id, subject_id])
}
