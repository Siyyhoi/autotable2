generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
}

model Room {
  // ใช้ room_id เป็น _id ของ Mongo โดยตรง
  room_id   String @id @map("_id") 
  room_name String
  room_type String
}

model StudentGroup {
  // ใช้ group_id เป็น _id ของ Mongo โดยตรง
  group_id    String     @id @map("_id")
  group_name  String
  group_count Int
  advisor     String
  registers   Register[]
}

model Subject {
  // ใช้ subject_id เป็น _id ของ Mongo โดยตรง
  subject_id   String     @id @map("_id")
  subject_name String
  theory       Int
  practice     Int
  credit       Int
  teaches      Teach[]
  registers    Register[]
}

model Teacher {
  // ใช้ teacher_id เป็น _id ของ Mongo โดยตรง
  teacher_id   String  @id @map("_id")
  teacher_name String
  role         String
  teaches      Teach[]
}

// --- ตารางเชื่อม ---
// จำเป็นต้องมีบรรทัด id นี้เฉพาะ 2 ตารางนี้เพื่อให้ MongoDB ยอมรับ (เป็นกฎของ Database)
// แต่ข้อมูล teacher_id, subject_id จะอิงตามไฟล์ CSV ของคุณเป๊ะๆ ครับ

model Teach {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  teacher_id String
  subject_id String
  
  teacher    Teacher @relation(fields: [teacher_id], references: [teacher_id])
  subject    Subject @relation(fields: [subject_id], references: [subject_id])

  @@unique([teacher_id, subject_id])
}

model Register {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  group_id   String
  subject_id String
  
  group      StudentGroup @relation(fields: [group_id], references: [group_id])
  subject    Subject      @relation(fields: [subject_id], references: [subject_id])

  @@unique([group_id, subject_id])
}